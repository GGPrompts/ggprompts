/**
 * Theme Utilities
 *
 * Glassmorphism, gradients, glows, and animations.
 * All utilities are theme-aware and work with any color theme and mode.
 */

@layer utilities {

  /* ===== GLASSMORPHISM ===== */

  /**
   * .glass - Standard glassmorphism effect
   * Semi-transparent with blur and theme-colored glow
   */
  .glass {
    background: rgba(var(--glass-bg), 0.15);
    backdrop-filter: blur(16px) saturate(180%);
    -webkit-backdrop-filter: blur(16px) saturate(180%);
    border: 1px solid hsl(var(--border) / 0.6);
    box-shadow:
      0 0 20px rgba(var(--primary-rgb), 0.2),
      inset 0 0 20px rgba(var(--primary-rgb), 0.08);
  }

  /**
   * .glass-dark - Darker glassmorphism variant
   * Higher opacity for better contrast
   */
  .glass-dark {
    background: rgba(var(--glass-dark-bg), 0.8);
    backdrop-filter: blur(16px) saturate(180%);
    -webkit-backdrop-filter: blur(16px) saturate(180%);
    border: 1px solid hsl(var(--border) / 0.5);
    box-shadow:
      0 0 15px rgba(var(--secondary-rgb), 0.2),
      inset 0 0 15px rgba(var(--secondary-rgb), 0.08);
  }

  /**
   * .glass-overlay - High-opacity readable overlay
   * Near-opaque for content that needs strong contrast
   */
  .glass-overlay {
    background: rgba(var(--glass-overlay-bg), 0.97);
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    border: 1px solid hsl(var(--border) / 0.6);
    box-shadow:
      0 0 20px rgba(var(--primary-rgb), 0.25),
      inset 0 0 20px rgba(var(--primary-rgb), 0.1);
  }

  /* Fallback for browsers without backdrop-filter support */
  @supports not (backdrop-filter: blur(1px)) {
    .glass,
    .glass-dark,
    .glass-overlay {
      background: hsl(var(--card)) !important;
    }
  }

  /* Light mode glass adjustments */
  :root[data-mode="light"] .glass {
    background: rgba(255, 255, 255, 0.7);
    border: 1px solid rgba(150, 140, 200, 0.25);
    box-shadow:
      0 4px 16px rgba(100, 80, 180, 0.08),
      0 1px 3px rgba(0, 0, 0, 0.06),
      inset 0 1px 0 rgba(255, 255, 255, 0.5);
  }

  :root[data-mode="light"] .glass-dark {
    background: rgba(250, 248, 255, 0.8);
    border: 1px solid rgba(150, 140, 200, 0.2);
    box-shadow:
      0 2px 8px rgba(100, 80, 180, 0.06),
      0 1px 2px rgba(0, 0, 0, 0.04),
      inset 0 1px 0 rgba(255, 255, 255, 0.4);
  }

  :root[data-mode="light"] .glass-overlay {
    background: rgba(255, 255, 255, 0.92);
    border: 1px solid rgba(150, 140, 200, 0.25);
    box-shadow:
      0 4px 16px rgba(100, 80, 180, 0.1),
      0 1px 3px rgba(0, 0, 0, 0.06),
      inset 0 1px 0 rgba(255, 255, 255, 0.6);
  }

  /* ===== GLOW EFFECTS ===== */

  /**
   * .terminal-glow - Text glow effect
   * Creates a phosphor/neon glow on text
   */
  .terminal-glow {
    text-shadow:
      0 0 10px rgba(var(--primary-rgb), 0.5),
      0 0 20px rgba(var(--primary-rgb), 0.3),
      0 0 30px rgba(var(--primary-rgb), 0.2);
  }

  /**
   * .border-glow - Border/box glow effect
   * Creates a soft glow around elements
   */
  .border-glow {
    box-shadow:
      0 0 10px rgba(var(--primary-rgb), 0.3),
      0 0 20px rgba(var(--primary-rgb), 0.1);
  }

  /* Reduce glow intensity in light mode */
  :root[data-mode="light"] .terminal-glow {
    text-shadow:
      0 0 6px rgba(var(--primary-rgb), 0.3),
      0 0 12px rgba(var(--primary-rgb), 0.15);
  }

  :root[data-mode="light"] .border-glow {
    box-shadow:
      0 0 8px rgba(var(--primary-rgb), 0.15),
      0 0 16px rgba(var(--primary-rgb), 0.05);
  }

  /* ===== GRADIENT TEXT ===== */

  /**
   * .gradient-text-theme - Theme-aware gradient text
   * Uses theme-specific gradient from --gradient-text variable
   */
  .gradient-text-theme {
    -webkit-background-clip: text !important;
    background-clip: text !important;
    color: transparent !important;
    background-image: var(--gradient-text, linear-gradient(to right, hsl(var(--primary)), hsl(var(--secondary))));
  }

  /**
   * .logo-icon-gradient - Gradient fill for icons/logos
   * Same gradient as text but for solid fills
   */
  .logo-icon-gradient {
    background-image: var(--gradient-text, linear-gradient(to bottom right, hsl(var(--primary)), hsl(var(--secondary))));
    background-size: 200% auto;
  }

  /* ===== ANIMATIONS ===== */

  @keyframes gradient {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }

  /**
   * .animate-gradient - Animated gradient background
   */
  .animate-gradient {
    background-size: 200% auto;
    animation: gradient 3s ease infinite;
  }

  @keyframes cursor-blink {
    0%, 50% { opacity: 1; }
    51%, 100% { opacity: 0; }
  }

  @keyframes cursor-blink-fast {
    0%, 50% { opacity: 1; }
    51%, 100% { opacity: 0; }
  }

  /**
   * .animate-cursor-blink - Terminal cursor blink
   */
  .animate-cursor-blink {
    animation: cursor-blink 1.2s infinite;
  }

  .group:hover .animate-cursor-blink {
    animation: cursor-blink-fast 0.6s infinite;
  }

  @keyframes pulse-glow {
    0%, 100% {
      box-shadow:
        0 0 10px rgba(var(--primary-rgb), 0.3),
        0 0 20px rgba(var(--primary-rgb), 0.1);
    }
    50% {
      box-shadow:
        0 0 20px rgba(var(--primary-rgb), 0.5),
        0 0 40px rgba(var(--primary-rgb), 0.2);
    }
  }

  /**
   * .animate-pulse-glow - Pulsing glow animation
   */
  .animate-pulse-glow {
    animation: pulse-glow 2s ease-in-out infinite;
  }

  @keyframes shimmer {
    0% {
      background-position: -200% 0;
    }
    100% {
      background-position: 200% 0;
    }
  }

  /**
   * .animate-shimmer - Shimmer loading effect
   */
  .animate-shimmer {
    background: linear-gradient(
      90deg,
      hsl(var(--muted)) 0%,
      hsl(var(--muted) / 0.5) 50%,
      hsl(var(--muted)) 100%
    );
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
  }

  /* ===== FOCUS UTILITIES ===== */

  /**
   * .focus-ring-theme - Theme-aware focus ring
   */
  .focus-ring-theme:focus-visible {
    outline: 2px solid hsl(var(--ring));
    outline-offset: 2px;
  }

  /* ===== SCROLLBAR UTILITIES ===== */

  /**
   * .scrollbar-hidden - Hide scrollbar but keep functionality
   */
  .scrollbar-hidden {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .scrollbar-hidden::-webkit-scrollbar {
    display: none;
  }

  /**
   * .scrollbar-visible - Styled visible scrollbar
   */
  .scrollbar-visible {
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--border)) transparent;
  }

  .scrollbar-visible::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  .scrollbar-visible::-webkit-scrollbar-track {
    background: transparent;
  }

  .scrollbar-visible::-webkit-scrollbar-thumb {
    background: hsl(var(--border));
    border-radius: 4px;
  }

  .scrollbar-visible::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--primary) / 0.7);
  }
}
